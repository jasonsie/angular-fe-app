<div class="image-upload-container">
  <h2>Image Upload</h2>

  <!-- Mock Images Section -->
  @if (mockImages().length > 0) {
  <div class="mock-images-section">
    <h3>Available Mock Images ({{ mockImages().length }})</h3>
    <div class="mock-controls">
      <button type="button" class="load-button" (click)="loadMockImagesFromService()">
        Reload from Service
      </button>
      <input
        type="text"
        placeholder="Search images..."
        #searchInput
        (keyup.enter)="searchMockImages(searchInput.value)"
        class="search-input"
      />
      <button type="button" class="search-button" (click)="searchMockImages(searchInput.value)">
        Search
      </button>
    </div>
    <div class="image-grid mock-grid">
      @for (image of mockImages(); track image.id) {
      <div class="image-item mock-item">
        <img [src]="image.url" [alt]="image.filename" class="preview-image" />
        <div class="image-info">
          <p class="image-name">
            <button
              type="button"
              class="download-button"
              (click)="downloadImage(image)"
              [title]="'Download ' + image.filename"
              aria-label="Download image"
            >
              <span class="download-icon">‚¨áÔ∏è</span>
              {{ image.filename }}
            </button>
          </p>
          <p class="image-size">{{ formatFileSize(image.size || 0) }}</p>
          @if (image.tags) {
          <div class="image-tags">
            @for (tag of image.tags; track tag) {
            <span class="tag">{{ tag }}</span>
            }
          </div>
          }
        </div>
      </div>
      }
    </div>
  </div>
  }

  <!-- Upload Area -->

<div
  class="upload-area"
  (dragover)="onDragOver($event)"
  (dragleave)="onDragLeave($event)"
  (drop)="onDrop($event)"
  [class.drag-over]="isDragOver()"
>
  <div class="upload-content">
    <div class="upload-icon">üìÅ</div>
    <p>Drag and drop images here or</p>
    <input
      type="file"
      #fileInput
      (change)="onFileSelected($event)"
      accept="image/*"
      multiple
      class="file-input"
    />
    <button type="button" class="browse-button" (click)="fileInput.click()">
      Browse Files
    </button>
  </div>
</div>

@if (selectedImages().length > 0) {
<div class="images-preview">
  <h3>Selected Images ({{ selectedImages().length }})</h3>
  <div class="image-grid">
    @for (image of selectedImages(); track image.id) {
    <div class="image-item">
      <img [src]="image.url" [alt]="image.file.name" class="preview-image" />
      <div class="image-info">
        <p class="image-name">
          <button
            type="button"
            class="download-button"
            (click)="downloadImage(image)"
            [title]="'Download ' + image.file.name"
            aria-label="Download image"
          >
            <span class="download-icon">‚¨áÔ∏è</span>
            {{ image.file.name }}
          </button>
        </p>
        <p class="image-size">{{ formatFileSize(image.file.size) }}</p>
      </div>
      <button
        type="button"
        class="remove-button"
        (click)="removeImage(image.id)"
        aria-label="Remove image"
      >
        ‚úï
      </button>
    </div>
    }
  </div>

  <div class="upload-actions">
    <button
      type="button"
      class="upload-button"
      (click)="uploadImages()"
      [disabled]="isUploading()"
    >
      @if (isUploading()) { Uploading... } @else { Upload
      {{ selectedImages().length }} Image(s) }
    </button>
    <button type="button" class="clear-button" (click)="clearImages()">
      Clear All
    </button>
  </div>
</div>
} @if (uploadProgress() > 0) {
<div class="upload-progress">
  <div class="progress-bar">
    <div class="progress-fill" [style.width.%]="uploadProgress()"></div>
  </div>
  <p>{{ uploadProgress() }}% uploaded</p>
</div>
} @if (uploadMessage()) {
<div
  class="upload-message"
  [class.success]="uploadSuccess()"
  [class.error]="!uploadSuccess()"
>
  {{ uploadMessage() }}
</div>
}

@if (isServiceLoading) {
<div class="loading-indicator">
  <p>Loading images from service...</p>
</div>
}
